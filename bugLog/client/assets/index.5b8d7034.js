import{r as t,c as e,o as a,a as o,b as n,F as s,d as r,S as c,C as i,p as l,e as d,t as u,w as p,f as g,g as m,h as b,i as h,j as v,k as f,l as w,m as y}from"./vendor.57c849f3.js";const _=t({user:{},account:{},bugs:{},activeBug:{},notes:[]});const E={name:"App",setup:()=>({appState:e((()=>_))})},k={class:"container-fluid"},T=n("footer",null,[n("div",{class:"bg-dark text-light text-center p-4"}," Made with 🐞 by Jonathan ")],-1);E.render=function(t,e,c,i,l,d){const u=r("Navbar"),p=r("router-view");return a(),o(s,null,[n("header",null,[n(u)]),n("main",null,[n("div",k,[n(p)])]),T],64)};class A{static async confirm(t="Are you sure?",e="You won't be able to revert this!",a="warning",o="Yes, delete it!"){try{return!!(await c.fire({title:t,text:e,icon:a,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:o})).isConfirmed}catch(n){return!1}}static toast(t="Warning!",e="warning",a="top-end",o=3e3,n=!0){c.fire({title:t,icon:e,position:a,timer:o,timerProgressBar:n,toast:!0,showConfirmButton:!1})}}const C=window.location.origin.includes("localhost"),O=C?"http://localhost:3000":"",x=i.create({baseURL:O,timeout:8e3});const I=new class{async getAll(){const t=await x.get("api/bugs");_.bugs=t.data}async getById(t){const e=await x.get("api/bugs/"+t);_.activeBug=e.data}async getNotes(t){const e=await x.get("api/bugs/"+t+"/notes");_.notes=e.data}async create(t){const e=await x.post("api/bugs",t);return _.bugs.push(e.data),e.data.id}async edit(t,e){const a=await x.put("api/bugs/"+e,t);_.activeBug=a.data}async destroy(t){await x.delete("api/bugs/"+t),this.getAll()}};const P={props:{bug:{type:Object,required:!0}},setup:t=>({date:e((function(){const e=t.bug.updatedAt.split("T")[0],a=e.split("-")[0];return`${e.split("-")[1]}-${e.split("-")[2]}-${a}`})),async close(t){try{await A.confirm("Ready To Close?","This cannot be reverted!","warning","Yes, Close It!")&&(await I.destroy(t),await I.getAll())}catch(e){A.toast(e)}}})},S=p("data-v-831bb828");l("data-v-831bb828");const j={class:"row border border-dark align-items-center"},R={class:"col-md-3 col-12 pt-2"},B={class:"pl-2"},N={class:"text-muted text-dark"},D={class:"col-md-4 col-12 pt-2"},L={class:"row align-items-center pb-md-2 pl-2"},U={class:"col-md-1 pb-md-0 pb-2"},H={class:"col-md-10 pb-md-0 pb-2 pt-2"},$={class:"pl-md-4"},V={class:"col-md-2 col-5 pt-2"},Y={key:0,class:"d-flex"},q=n("h5",{class:"pl-2"},"Open ",-1),z={key:1,class:"d-flex"},G=n("h5",{class:"pl-2"},"Closed ",-1),M=n("h5",{class:"pl-1"}," 🔴",-1),W={class:"col-md-3 col-7 pt-2"},K={class:"pl-2"};d();const F=S(((t,e,s,c,i,l)=>{var d,p;const g=r("router-link");return a(),o("div",j,[n("div",R,[n("h5",B,[n(g,{to:{name:"Info",params:{bugId:s.bug.id}}},{default:S((()=>[n("span",N,u(s.bug.title),1)])),_:1},8,["to"])])]),n("div",D,[n("div",L,[n("div",U,[n("img",{src:null==(d=s.bug.creator)?void 0:d.picture,alt:"ProfilePicture",height:"40",class:"rounded rounded-circle"},null,8,["src"])]),n("div",H,[n("h5",$,u(null==(p=s.bug.creator)?void 0:p.name),1)])])]),n("div",V,[!1===s.bug.closed?(a(),o("span",Y,[q,n("h5",{class:"pl-3 action",onClick:e[1]||(e[1]=t=>c.close(s.bug.id))}," 🟢")])):(a(),o("span",z,[G,M]))]),n("div",W,[n("h5",K,u(c.date),1)])])}));P.render=F,P.__scopeId="data-v-831bb828";var J=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:P});let Q;const X={},Z=function(t,e){if(!e||0===e.length)return t();if(void 0===Q){const t=document.createElement("link").relList;Q=t&&t.supports&&t.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(e.map((t=>{if(t in X)return;X[t]=!0;const e=t.endsWith(".css"),a=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${a}`))return;const o=document.createElement("link");return o.rel=e?"stylesheet":Q,e||(o.as="script",o.crossOrigin=""),o.href=t,document.head.appendChild(o),e?new Promise(((t,e)=>{o.addEventListener("load",t),o.addEventListener("error",e)})):void 0}))).then((()=>t()))};function tt(t){return()=>function(t){switch(t){case"./pages/AccountPage.vue":return Z((()=>import("./AccountPage.079ea41a.js")),["/assets/AccountPage.079ea41a.js","/assets/AccountPage.f3fa63f7.css","/assets/vendor.57c849f3.js"]);case"./pages/BugInfoPage.vue":return Z((()=>import("./BugInfoPage.ab4f4301.js")),["/assets/BugInfoPage.ab4f4301.js","/assets/BugInfoPage.532f5eb8.css","/assets/vendor.57c849f3.js"]);case"./pages/HomePage.vue":return Z((()=>import("./HomePage.db3ed607.js")),["/assets/HomePage.db3ed607.js","/assets/HomePage.b721a944.css","/assets/vendor.57c849f3.js"]);default:return Promise.reject(new Error("Unknown variable dynamic import: "+t))}}(`./pages/${t}.vue`)}const et=[{path:"/",name:"Home",component:tt("HomePage"),beforeEnter:b},{path:"/bug/:bugId",name:"Info",component:tt("BugInfoPage"),beforeEnter:b},{path:"/account",name:"Account",component:tt("AccountPage"),beforeEnter:b}],at=g({linkActiveClass:"router-link-active",linkExactActiveClass:"router-link-exact-active",history:m(),routes:et});function ot(t,e){if(C)console[t](`[${t}] :: ${(new Date).toLocaleTimeString()} :: `,...e);else{switch(t){case"log":case"assert":return}console[t](`[${t}] :: ${(new Date).toLocaleTimeString()} :: `,...e)}}const nt={log(){ot("log",arguments)},error(){ot("error",arguments)},warn(){ot("warn",arguments)},assert(){ot("assert",arguments)},trace(){ot("trace",arguments)}};const st=new class{async getAccount(){try{const t=await x.get("/account");_.account=t.data}catch(t){nt.error("HAVE YOU STARTED YOUR SERVER YET???",t)}}};let rt=!1,ct=[];const it="connected",lt="authenticate",dt="authenticated",ut="error";const pt=new class extends class{constructor(t=O){this.socket=h(t||O),this.on(it,this.onConnected).on(dt,this.onAuthenticated).on(ut,this.onError)}on(t,e){return this.socket.on(t,e.bind(this)),this}onConnected(t){nt.log("[SOCKET_CONNECTION]",t),rt=!0}onAuthenticated(t){nt.log("[SOCKET_AUTHENTICATED]",t);const e=[...ct];ct=[],e.forEach((t=>{this.emit(t.action,t.payload)}))}authenticate(t){this.socket.emit(lt,t)}onError(t){nt.error("[SOCKET_ERROR]",t)}emit(t,e){if(!rt)return nt.log("[ENQUEING_ACTION]",{action:t,payload:e}),ct.push({action:t,payload:e});this.socket.emit(t,e)}}{constructor(){super(),this.on("error",this.onError)}onError(t){nt.error("[SOCKET_ERROR]",t),A.toast(t.message,"error")}},gt=v({domain:"codeworks-jonathan.us.auth0.com",clientId:"VYUajEjgjOLtoXIIDWGBbAAMD0tgS5qG",audience:"https://bug-log/",useRefreshTokens:!0,onRedirectCallback:t=>{at.push(t&&t.targetUrl?t.targetUrl:window.location.pathname)}});async function mt(t){if(!gt.isAuthenticated)return t;const e=1e3*gt.identity.exp,a=e<Date.now(),o=e<Date.now()+432e5;return a?await gt.loginWithPopup():o&&(await gt.getTokenSilently(),x.defaults.headers.authorization=gt.bearer,pt.authenticate(gt.bearer)),t}gt.on(gt.AUTH_EVENTS.AUTHENTICATED,(async function(){x.defaults.headers.authorization=gt.bearer,x.interceptors.request.use(mt),_.user=gt.user,await st.getAccount(),pt.authenticate(gt.bearer)}));const bt={setup:()=>({state:t({dropOpen:!1}),user:e((()=>_.user)),async login(){gt.loginWithPopup()},async logout(){gt.logout({returnTo:window.location.origin})}})},ht=p("data-v-28634cc5");l("data-v-28634cc5");const vt={class:"navbar navbar-expand-lg navbar-dark bg-dark"},ft=n("div",{class:"d-flex flex-column align-items-center"}," BUGLOG ",-1),wt=n("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[n("span",{class:"navbar-toggler-icon"})],-1),yt={class:"collapse navbar-collapse",id:"navbarText"},_t={class:"navbar-nav mr-auto"},Et={class:"nav-item"},kt=f(" Home "),Tt={class:"navbar-text"},At={key:1,class:"dropdown"},Ct={class:"mx-3"},Ot=n("div",{class:"list-group-item list-group-item-action hoverable"}," Account ",-1);d();const xt=ht(((t,e,s,c,i,l)=>{const d=r("router-link");return a(),o("nav",vt,[n(d,{class:"navbar-brand d-flex",to:{name:"Home"}},{default:ht((()=>[ft])),_:1}),wt,n("div",yt,[n("ul",_t,[n("li",Et,[n(d,{to:{name:"Home"},class:"nav-link"},{default:ht((()=>[kt])),_:1})])]),n("span",Tt,[c.user.isAuthenticated?(a(),o("div",At,[n("div",{class:"dropdown-toggle",onClick:e[2]||(e[2]=t=>c.state.dropOpen=!c.state.dropOpen)},[n("img",{src:c.user.picture,alt:"user photo",height:"40",class:"rounded"},null,8,["src"]),n("span",Ct,u(c.user.name),1)]),n("div",{class:["dropdown-menu p-0 list-group w-100",{show:c.state.dropOpen}],onClick:e[4]||(e[4]=t=>c.state.dropOpen=!1)},[n(d,{to:{name:"Account"}},{default:ht((()=>[Ot])),_:1}),n("div",{class:"list-group-item list-group-item-action hoverable",onClick:e[3]||(e[3]=(...t)=>c.logout&&c.logout(...t))}," logout ")],2)])):(a(),o("button",{key:0,class:"btn btn-outline-primary text-uppercase",onClick:e[1]||(e[1]=(...t)=>c.login&&c.login(...t))}," Login "))])])])}));bt.render=xt,bt.__scopeId="data-v-28634cc5";var It=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:bt});const Pt=new class{async create(t){const e=await x.post("api/notes",t);return _.notes.push(e.data),e.data}async destroy(t){await x.delete("api/notes/"+t),_.notes=_.notes.filter((e=>e.id!==t))}};const St={props:{note:{type:Object,required:!0}},setup:()=>({account:e((()=>_.account)),async destroy(t,e){try{await A.confirm()&&(await Pt.destroy(t),await I.getNotes(e))}catch(a){A.toast(a)}}})},jt=p("data-v-75b8549b");l("data-v-75b8549b");const Rt={class:"row bg-light text-dark align-items-center border border-dark"},Bt={class:"col-md-3 col-12 pt-2 d-flex align-items-center"},Nt={class:"row align-items-center pb-md-2"},Dt={class:"col-md-2 pb-md-0 pb-2"},Lt={class:"col-md-10 pb-md-0 pb-2 pt-2"},Ut={class:"pl-3"},Ht={class:"col-md-8 col-12 pt-2"},$t={class:"pl-3"},Vt={class:"col-md-1 col-12 pt-2 d-flex justify-content-md-center pr-md-5 justify-content-end"};d();const Yt=jt(((t,e,s,r,c,i)=>{var l,d;return a(),o("div",Rt,[n("div",Bt,[n("div",Nt,[n("div",Dt,[n("img",{src:null==(l=s.note.creator)?void 0:l.picture,alt:"ProfilePicture",height:"50",class:"rounded rounded-circle"},null,8,["src"])]),n("div",Lt,[n("h5",Ut,u(null==(d=s.note.creator)?void 0:d.name),1)])])]),n("div",Ht,[n("h5",$t,u(s.note.body),1)]),n("div",Vt,[s.note.creatorId===r.account.id?(a(),o("h5",{key:0,class:"action",onClick:e[1]||(e[1]=t=>r.destroy(s.note.id,s.note.bug))}," 🗑 ")):w("",!0)])])}));St.render=Yt,St.__scopeId="data-v-75b8549b";var qt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:St});const zt=y(E);!function(t){const e={"./components/BugCard.vue":J,"./components/Navbar.vue":It,"./components/NoteCard.vue":qt};Object.entries(e).forEach((([e,a])=>{const o=a.name||e.substr(e.lastIndexOf("/")+1).replace(/\.\w+$/,"");t.component(o,a.default)}))}(zt),zt.use(at).mount("#app");export{_ as A,A as P,I as b,Pt as n};
